/*!
 * chceckFrom, Adam Mikó
 * version: 1.5.0 (28.08.2013)
 * @requires jQuery v1.9+
 *
 * http://opensource.org/licenses/MIT
 */
;(function($,r,s,t){var u="checkForm",checkInputs=$('input, textarea, select').not(':input[type=button], :input[type=submit], :input[type=reset]'),defaults={setAttr:"data-check",setGroup:"data-group",setMsg:"data-msg",errorClass:"errInput",ajax:false,debug:false},runError,item={},IDItem={};function Plugin(a,b,c){this.element=a;this.options=$.extend({init:function(){},error:function(){},success:function(){}},defaults,b,c);this._defaults=defaults;this._name=u;this.checkInputs(a,b,defaults);if(!runError){this.init(a,b);this.setRandomId(a,b)}}Plugin.prototype={init:function(a,b){if(b.init!=null)b.init.call(this,b)},setRandomId:function(a,b){var c=u+"_",lengthString=15,charArray="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i;for(i=0;i<lengthString;i++)c+=charArray.charAt(Math.floor(Math.random()*charArray.length));return $(a).data('data-id',c)},checkInputs:function(c,d,e){var f=$(c);f.find("["+e.setAttr+"]").each(function(a,b){var b=$(b);if(b.is(e.checkInputs)){r.alert("Zadané nesprávne elementy na kontrolu, plugin sa nespusti");f.data("data-run",false)}});if(runError){f.data("data-run",false)}else{f.data("data-run",true)}}};$.fn.validate=function(a){var b=false;if(this.val().length<=0||this.val()==a){b=true}return b};$.fn[u]=function(p,q){return this.each(function(){if(!$.data(this,"plugin_"+u))$.data(this,"plugin_"+u,new Plugin(this,p));if(!$(this).data("data-run"))return false;function getCheckInputs(d,e){var f=null;if(p.debug)console.log(d);d.find("["+defaults.setGroup+"]").each(function(a,b){var c=$(b).data("group").min;f=getCheckGroupElements(b,c)});getCheckElemets(d,f,e)};function getCheckElemets(j,k,l){var m=false;var n=new RegExp("^[_a-zA-Z0-9\.\-]+@[_a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,4}$");var o=0;j.find('td').not("["+defaults.setGroup+"]").each(function(h,i){var i=$(i);i.find(checkInputs).each(function(a,b){var b=$(b);var c=b.attr("name");var d=b.val();b.val($.trim(b.val()));var e=b.attr(defaults.setMsg);if(b.attr(defaults.setAttr)!=""&&b.attr(defaults.setAttr)!=t){switch(b.attr(defaults.setAttr)){case"true":var f=b.attr('id');if(b.is(":text, :password, textarea")&&b.validate(e)){if(e!="")b.val(e);b.addClass(defaults.errorClass);o+=1;m=true;if(f==t){IDItem[c]='Nebolo nájdene žiadne ID'}else{IDItem[c]=f}}else if(b.is(":text, :password, textarea")&&!b.validate(e)){b.removeClass(defaults.errorClass)}else if(b.is("select, :file")&&b.val()==""){b.addClass(defaults.errorClass);o+=1;m=true;if(f==""){IDItem[c]='Nebolo nájdene žiadne ID'}else{IDItem[c]=f}}else if(b.is(":checkbox")&&!b.prop('checked')){$('label[for="'+f+'"]').addClass(defaults.errorClass);o+=1;m=true;if(f==t){IDItem[c]='Nebolo nájdene žiadne ID'}else{IDItem[c]=f}}else if(b.is(":checkbox")&&b.prop('checked')){$('label[for="'+f+'"]').removeClass(defaults.errorClass)}break;case"email":if(b.is(":text")){if(!n.test(b.val())||b.val()==e){if(e!="")b.val(e);b.addClass(defaults.errorClass);o+=1;m=true;if(f==t){IDItem[c]='Nebolo nájdene žiadne ID'}else{IDItem[c]=f}}else{b.removeClass(defaults.errorClass)}}else{r.alert("Email môže mať len input type: text\n(ID: "+b.attr("id")+",element: "+b[0].tagName+")");o+=1;m=true}break;default:if(b.is(":text, textarea")){var g=new RegExp(b.attr(defaults.setAttr));if(!g.test(b.val())||b.val()==e){if(e!="")b.val(e);b.addClass(defaults.errorClass);o+=1;m=true;if(f==t){IDItem[c]='Nebolo nájdene žiadne ID'}else{IDItem[c]=f}}else{b.removeClass(defaults.errorClass)}}else{r.alert("Vlastný regexp môžu mať len inputy type: text\nID chybného inputu: "+b.attr("id"));o+=1;m=true}break}}if(p.debug){console.log(c,": "+b.val());console.log(c+' errMsg: '+e)}item[c]=d})});if(k&&m){setCheckError(l,o,IDItem)}else if(k||m){setCheckError(l,o,IDItem)}else{setCheckAccept(l,item)}};function getCheckGroupElements(e,f){var g=0;var h=false;$(e).find(checkInputs).each(function(a,b){if($(e).data('group').check=="manual"){if($(b).is(':checkbox')&&$(b).attr(defaults.setAttr)){var c=$(b).prop('checked');if(c){var d=$(b).attr("name");item[d]=c;++g}}}else if($(e).data('group').check=="all"){if($(b).is(':checkbox')){var c=$(b).prop('checked');if(c){var d=$(b).attr("name");item[d]=c;++g}}}});if(g<f)h=true;return h};function setCheckError(a,b,c){if(p.error!=null)p.error.call(this,b,c);a.preventDefault()};function setCheckAccept(a,b){if(p.ajax)a.preventDefault();if(p.success!=null)p.checkSuccess.call(this,b);$("."+defaults.errorClass).removeClass(defaults.errorClass)};$(this).on("submit",function(a){var b=$(this);var c=a;getCheckInputs(b,c)})})}})(jQuery,window,document);
